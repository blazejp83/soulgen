---
phase: 02-wizard-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/wizard/page.tsx
  - src/components/wizard/wizard-shell.tsx
  - src/components/wizard/wizard-progress.tsx
  - src/components/wizard/wizard-nav.tsx
  - src/components/wizard/steps/archetype-step.tsx
  - src/lib/archetypes.ts
autonomous: true
---

<objective>
Build the wizard shell (layout, progress indicator, step navigation) and the archetype selection step — the first wizard screen users see.

Purpose: This is the container all other wizard steps render inside. Without it, no step UI can exist. The archetype step is included because it's the entry point and defines the data that pre-fills subsequent steps.
Output: Working /wizard route with progress bar, back/next navigation, and archetype card selection with preset pre-filling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/types/index.ts
@src/stores/wizard-store.ts
@src/stores/settings-store.ts
@src/components/app-header.tsx
@src/app/layout.tsx
@src/app/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create wizard shell with progress indicator, step navigation, and archetype data</name>
  <files>src/app/wizard/page.tsx, src/components/wizard/wizard-shell.tsx, src/components/wizard/wizard-progress.tsx, src/components/wizard/wizard-nav.tsx, src/lib/archetypes.ts</files>
  <action>
**Archetype data (src/lib/archetypes.ts):**
Define ARCHETYPES constant — array of archetype objects with: id (ArchetypeId), name, description (1 sentence), icon (lucide-react icon name string), tags (string[]), and defaults (Partial<AgentDNA> with temperament/communication/workStyle/userRelationship overrides). Archetypes: developer, researcher, devops, pm, coach, storyteller, general. Each archetype should have sensible non-neutral preset values (e.g., developer: high jargon, structured preference, deep-dive depth; coach: high warmth, gentle feedback, friendly address). Also export a "custom" option (id: "custom", no defaults).

**Wizard progress (src/components/wizard/wizard-progress.tsx):**
"use client" component. Reads currentStep from useWizardStore. Define WIZARD_STEPS array: [{id: WizardStep, label: string}] for all 7 steps. Render a horizontal step indicator: numbered circles connected by lines. Current step highlighted, completed steps filled, future steps dimmed. Clicking a completed or current step navigates to it (calls setStep). Use Tailwind for styling — no extra deps.

**Wizard nav (src/components/wizard/wizard-nav.tsx):**
"use client" component. Accepts `onNext?: () => void` and `onBack?: () => void` props for step-specific validation. Reads currentStep from useWizardStore. Renders Back and Next buttons. Back disabled on first step ("archetype"). Next says "Review & Generate" on second-to-last step ("domains") and is hidden on "summary" step. Back navigates to previous step in WIZARD_STEPS order. Next navigates to next step. Use the store's setStep action.

**Wizard shell (src/components/wizard/wizard-shell.tsx):**
"use client" component. Renders WizardProgress at top, then a content area that conditionally renders the step component based on currentStep, then WizardNav at bottom. Uses useWizardStore for currentStep. Import and render step components: ArchetypeStep for "archetype", placeholder divs with step name text for all other steps (they'll be built in plans 02-02 and 02-03). Wrap in a max-w-3xl centered container with padding.

**Wizard page (src/app/wizard/page.tsx):**
Server component that renders WizardShell. Simple wrapper — `export default function WizardPage() { return <WizardShell /> }`.

Use useMounted hook from src/hooks/use-mounted.ts in all "use client" components that read from Zustand stores to prevent SSR hydration mismatch. When not mounted, render a minimal skeleton/loading state.
  </action>
  <verify>npm run build succeeds with no TypeScript errors</verify>
  <done>
- /wizard route renders wizard shell with progress indicator showing 7 steps
- Step indicator highlights current step, dims future steps
- Back/Next navigation works and updates store
- Placeholder content renders for non-archetype steps
  </done>
</task>

<task type="auto">
  <name>Task 2: Build archetype selection step with card grid and preset pre-filling</name>
  <files>src/components/wizard/steps/archetype-step.tsx</files>
  <action>
**Archetype step (src/components/wizard/steps/archetype-step.tsx):**
"use client" component. Import ARCHETYPES from src/lib/archetypes.ts. Read current dna.archetype from useWizardStore. Render a grid of archetype cards (2-3 columns responsive). Each card shows: icon (use lucide-react icon component dynamically or map id to icon), name, description, and tags as small badges. Selected card has a highlighted border/ring. Also include a "Start from Scratch" option (custom archetype) — a simpler card.

On card click:
1. Call setArchetype(id)
2. If the archetype has defaults, merge them into DNA using the granular update functions (updateTemperament, updateCommunication, updateWorkStyle, updateUserRelationship, toggleDomain for domains). This pre-fills subsequent steps.
3. If "custom" selected, call resetDNA then setArchetype("custom") — but actually, don't fully reset if user already configured things. Just set archetype to "custom" without changing other values.

Handle the settings store mode: if mode === "simple", show only a subset of archetypes (developer, researcher, coach, general). If mode === "advanced", show all 7 + custom.

Requirements covered: ARCH-01, ARCH-02, ARCH-03, ARCH-04, ARCH-05 (override happens naturally in later steps since archetype only sets defaults).
  </action>
  <verify>npm run build succeeds with no TypeScript errors</verify>
  <done>
- Archetype cards render in responsive grid
- Clicking a card selects it (visual highlight) and pre-fills DNA defaults
- "Start from Scratch" option available
- Simple mode shows subset, Advanced shows all
- ARCH-01 through ARCH-05 requirements addressed
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /wizard route accessible and renders wizard shell
- [ ] Progress indicator shows 7 steps with correct labels
- [ ] Archetype cards render and selection works
- [ ] Back/Next navigation changes steps
- [ ] Store persistence works (refresh preserves step + archetype selection)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Wizard shell is ready for other steps to plug into
- Archetype selection pre-fills DNA correctly
  </success_criteria>

<output>
After completion, create `.planning/phases/02-wizard-ui/02-01-SUMMARY.md`
</output>
